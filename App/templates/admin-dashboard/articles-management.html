{% extends 'admin-dashboard/layout.html' %} {% block title %} Dashboard - User Management {% endblock %} {% block container %}
<div class="container-fluid">
    <h2 class="fw-bolder">Articles Management</h2>
    <p class="text-muted mb-4">Manage articles here</p>
    <div class="row mb-3">
        <div class="col-md-6 col-sm-12 mb-lg-0 mb-sm-3">
            <input type="text" id="searchInput" class="form-control bg-light" placeholder="Search users..." />
        </div>
        <div class="col-md-6 col-sm-12">
            <select id="roleFilter" class="form-select bg-light">
                <option value="">All Roles</option>
                <option value="personal">Personal</option>
                <option value="petani">Petani</option>
                <option value="ahli">Ahli</option>
            </select>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table table-light table-hover">
            <thead>
                <tr>
                    <th scope="col">No</th>
                    <th scope="col">Judul</th>
                    <th scope="col">Created At</th>
                    <th scope="col">Created By</th>
                    <th scope="col">Status</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for article in all_data %}
                <tr class="align-middle">
                    <td>{{ loop.index }}</td>
                    <td class="text-truncate" style="max-width: 132px">{{ article.judul or 'N/A' }}</td>
                    <td>{{ article.created_at }}</td>
                    <td>{{ article.created_by }}</td>
                    <!-- Nama lengkap user yang dibuat -->
                    <td>
                        <div class="d-flex gap-2">
                            <span class="badge {% if article.is_drafted %} bg-secondary {% else %} bg-success {% endif %}"> {% if article.is_drafted %} Drafted {% else %} Posted {% endif %} </span>
                            <span class="badge {% if article.is_approved %} bg-success {% else %} bg-warning {% endif %}"> {% if article.is_approved %} Approved {% else %} Disapproved {% endif %} </span>
                        </div>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-info" data-bs-toggle="modal" data-bs-target="#articlesDetailModal{{article.id}}">Details</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center" id="pagination">
            <!-- Pagination will be populated here -->
        </ul>
    </nav>
</div>

<!-- Modal for user details -->
{% for item in all_data %}
<div class="modal fade" id="articlesDetailModal{{ item.id }}" tabindex="-1" aria-labelledby="articlesDetailModal{{ item.id }}Label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="articlesDetailModal{{ item.id }}Label">Article Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="userDetailsBody">
                <p><strong>Judul:</strong> {{item.judul}}</p>
                <p><strong>Oleh:</strong> {{item.created_by}}</p>
                <p><strong>Dibuat pada:</strong> {{item.created_at}}</p>
                <p><strong>Konten:</strong> {{item.content | safe}}</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                <a href="{{ url_for('admin_page.approve_article', id=item.id ) }}" role="button" class="btn btn-primary {% if item.is_drafted or item.is_approved %} disabled {% endif %}" {% if item.is_drafted %} disabled {% endif %}
                    >Setujui Artikel</a
                >
            </div>
        </div>
    </div>
</div>
{% endfor %}

<!-- Modal for user verification -->
<div class="modal fade" id="userVerificationModal" tabindex="-1" aria-labelledby="userVerificationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userVerificationModalLabel">Verify User Upgrade Request</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="userVerificationBody">...</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-success" id="approveUpgradeBtn">Approve</button>
                <button type="button" class="btn btn-danger" id="rejectUpgradeBtn">Reject</button>
            </div>
        </div>
    </div>
</div>
{% endblock %} {% block scripts %} {% endblock %}
